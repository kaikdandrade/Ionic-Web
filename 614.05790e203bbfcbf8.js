"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[614],{614:(A,c,i)=>{i.r(c),i.d(c,{EditPageModule:()=>P});var f=i(6814),u=i(95),a=i(7852),g=i(7030),p=i(5861),e=i(9468),d=i(4073),r=i(9493),E=i(9026),Z=i(553);function v(t,l){if(1&t&&e._UZ(0,"ion-img",15),2&t){const o=e.oxw();e.MGl("alt","Foto do documento ",o.form.name,""),e.Q6J("src",o.form.imagem.url)}}function M(t,l){if(1&t&&e._UZ(0,"ion-img",15),2&t){const o=e.oxw();e.MGl("alt","Foto alterado do documento ",o.form.name,""),e.Q6J("src",o.imagem.url)}}const J=[{path:"",component:(()=>{class t{constructor(){this.env=Z.N,this.alertSend=!1,this.alertButtons=[{text:"Cancel",handler:()=>{this.alertSend=!1}},{text:"Confirm",handler:()=>{this.sendForm()}}],this.imagem={url:"",format:"",uploaded:!1},this.form={name:"",location:"",description:"",imagem:{url:"",name:"",format:""},date:"",status:"received"},this.sending=!1,this.docId="0",this.firestore=(0,e.f3M)(d.gg),this.storage=(0,e.f3M)(r.Ke),this.router=(0,e.f3M)(g.F0),this.general=(0,e.f3M)(E.m),this.contactsCollection=(0,d.hJ)(this.firestore,"documents")}ngOnInit(){var o=this;return(0,p.Z)(function*(){o.docId=void 0===history.state.index?"0":history.state.index,"0"==o.docId&&o.router.navigate(["/home"]),o.docSnap=yield(0,d.QT)((0,d.JU)(o.firestore,"documents",o.docId)),o.documents=o.docSnap.data(),o.general.formValues(o.form,o.documents)})()}ngOnDestroy(){this.general.formValues(this.form,null),this.general.formValues(this.documents,null)}sendForm(){var o=this;return(0,p.Z)(function*(){if(!(o.form.name.length<3||o.form.location.length<3||o.form.description.length<5||""===o.form.imagem.url||o.sending)){o.sending=!0;try{var n=o.form.imagem.name;if(o.imagem.uploaded){const m=(0,r.cF)(),s=(0,r.iH)(m,`${o.form.imagem.name}.${o.form.imagem.format}`);yield(0,r.oq)(s).catch(C=>{console.log("Erro ao deletar a imagem",C)}),n=o.general.getRandomChars(10);const h=(0,r.iH)(o.storage,`${n}.${o.imagem.format}`);yield(0,r.sf)(h,o.imagem.url.split(",")[1],"base64",{contentType:`image/${o.imagem.format}`});const T=yield(0,r.Jt)((0,r.iH)(h));o.form.imagem.url=T,o.form.imagem.format=o.imagem.format}yield(0,d.r7)((0,d.JU)(o.firestore,"documents",o.docId),{name:o.form.name,location:o.form.location,description:o.form.description,imagem:{url:o.form.imagem.url,format:o.form.imagem.format,name:n}})}catch(m){return console.error("Erro ao enviar o formul\xe1rio",m),void(o.sending=!1)}finally{o.general.formValues(o.form,null),o.general.formValues(o.documents,null),o.sending=!1,setTimeout(()=>{o.router.navigate(["/home"])},1e3)}}})()}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-edit"]],decls:32,vars:13,consts:[[3,"translucent"],["slot","start"],[1,"ion-text-center"],["name","pencil","size","large","slot","end",1,"ion-margin"],[1,"ion-padding"],["label","Nome:","type","text","name","name","label-placement","floating","fill","outline","placeholder","Nome do documento","error-text","Nome inv\xe1lido!","minlength","3","required","",3,"autofocus","ngModel","ngModelChange"],["label","Localiza\xe7\xe3o:","type","text","name","location","label-placement","floating","fill","outline","placeholder","Localiza\xe7\xe3o do documento","error-text","Localiza\xe7\xe3o inv\xe1lida!","minlength","3","required","",3,"ngModel","ngModelChange"],["label","Descri\xe7\xe3o do documento:","name","description","labelPlacement","floating","fill","outline","placeholder","Descri\xe7\xe3o do documento","error-text","Descri\xe7\xe3o inv\xe1lida!","minlength","5","required","",3,"autoGrow","ngModel","ngModelChange"],["style","height: 250px;",3,"src","alt",4,"ngIf"],[3,"click"],["name","pencil","slot","start"],["name","send","slot","start"],["header","Realmente deseja alterar os dados deste documento?",3,"buttons","isOpen"],["showBackdrop","false","message","Carregando...","spinner","circles",1,"custom-loading",3,"isOpen"],["target","_blank","title","copyright",3,"href"],[2,"height","250px",3,"src","alt"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title",2),e._uU(5,"Editar documento"),e.qZA(),e._UZ(6,"ion-icon",3),e.qZA()(),e.TgZ(7,"ion-content",4)(8,"p"),e._uU(9,'Altere os dados dos campos e aperte "enviar para editar o documento".'),e.qZA(),e.TgZ(10,"p")(11,"ion-input",5),e.NdJ("ngModelChange",function(s){return n.form.name=s}),e.qZA()(),e.TgZ(12,"p")(13,"ion-input",6),e.NdJ("ngModelChange",function(s){return n.form.location=s}),e.qZA()(),e.TgZ(14,"p")(15,"ion-textarea",7),e.NdJ("ngModelChange",function(s){return n.form.description=s}),e.qZA()(),e.YNc(16,v,1,2,"ion-img",8),e.YNc(17,M,1,2,"ion-img",8),e.TgZ(18,"ion-button",9),e.NdJ("click",function(){return n.general.getPhoto(n.imagem)}),e._UZ(19,"ion-icon",10),e._uU(20," Alterar "),e.qZA(),e.TgZ(21,"p")(22,"ion-button",9),e.NdJ("click",function(){return n.alertSend=!0}),e._UZ(23,"ion-icon",11),e._uU(24," Enviar "),e.qZA()(),e._UZ(25,"ion-alert",12)(26,"ion-loading",13),e.qZA(),e.TgZ(27,"ion-footer")(28,"ion-toolbar")(29,"ion-title",2)(30,"a",14),e._uU(31),e.qZA()()()()),2&o&&(e.Q6J("translucent",!0),e.xp6(11),e.Q6J("autofocus",!0)("ngModel",n.form.name),e.xp6(2),e.Q6J("ngModel",n.form.location),e.xp6(2),e.Q6J("autoGrow",!0)("ngModel",n.form.description),e.xp6(1),e.Q6J("ngIf",!n.imagem.uploaded),e.xp6(1),e.Q6J("ngIf",n.imagem.uploaded),e.xp6(8),e.Q6J("buttons",n.alertButtons)("isOpen",n.alertSend),e.xp6(1),e.Q6J("isOpen",n.sending),e.xp6(4),e.Q6J("href",n.env.authorUrl,e.LSH),e.xp6(1),e.hij("\xa9 2023 ",n.env.author,"."))},dependencies:[f.O5,u.JJ,u.Q7,u.wO,u.On,a.Ge,a.YG,a.Sm,a.W2,a.fr,a.Gu,a.gu,a.Xz,a.pK,a.wh,a.fG,a.g2,a.wd,a.sr,a.j9]}),t})()}];let y=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[g.Bz.forChild(J),g.Bz]}),t})(),P=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[f.ez,u.u5,a.Pc,y]}),t})()}}]);